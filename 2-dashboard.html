<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Executive Economics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="2-dashboard_files/libs/clipboard/clipboard.min.js"></script>
<script src="2-dashboard_files/libs/quarto-html/quarto.js"></script>
<script src="2-dashboard_files/libs/quarto-html/popper.min.js"></script>
<script src="2-dashboard_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="2-dashboard_files/libs/quarto-html/anchor.min.js"></script>
<link href="2-dashboard_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="2-dashboard_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="2-dashboard_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="2-dashboard_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="2-dashboard_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="2-dashboard_files/libs/quarto-dashboard/quarto-dashboard.js"></script>
<script src="2-dashboard_files/libs/quarto-dashboard/stickythead.js"></script>
<script src="2-dashboard_files/libs/quarto-dashboard/datatables.min.js" kdttablesentinel="true"></script>
<script src="2-dashboard_files/libs/quarto-dashboard/pdfmake.min.js" kdttablesentinel="true"></script>
<script src="2-dashboard_files/libs/quarto-dashboard/vfs_fonts.js" kdttablesentinel="true"></script>
<script src="2-dashboard_files/libs/quarto-dashboard/web-components.js" type="module"></script>
<script src="2-dashboard_files/libs/quarto-dashboard/components.js"></script>
<link href="2-dashboard_files/libs/quarto-dashboard/datatables.min.css" rel="stylesheet" kdttablesentinel="true">


</head>

<body class="quarto-dashboard dashboard-fill dashboard-sidebar fullcontent">

<header id="quarto-dashboard-header">
<nav class="navbar navbar-expand-md slim" data-bs-theme="dark">
  <div class="navbar-container container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-controls="dashboard-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>    


    <div class="navbar-brand-container">       
    <a href="#"><img src="images/Executive_Economics_Logo.png" alt="" class="navbar-logo d-inline-block"></a>
      <div class="navbar-title">
        <div class="navbar-title-text"><a href="#">Executive Economics</a></div>
        
        
      </div>
    </div>
<div id="dashboard-collapse" class="navbar-collapse collapse"><ul class="navbar-nav navbar-nav-scroll me-auto" role="tablist"><li class="nav-item" role="presentation"><a id="tab-home" class="nav-link active" data-bs-toggle="tab" role="tab" data-bs-target="#home" data-scrolling="false" href="#home" aria-controls="home" aria-selected="true"><span class="nav-link-text">Home</span></a></li><li class="nav-item" role="presentation"><a id="tab-historical-data" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#historical-data" data-scrolling="false" href="#historical-data" aria-controls="historical-data" aria-selected="false"><span class="nav-link-text">Historical Data</span></a></li><li class="nav-item" role="presentation"><a id="tab-comparing-presidents" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#comparing-presidents" data-scrolling="false" href="#comparing-presidents" aria-controls="comparing-presidents" aria-selected="false"><span class="nav-link-text">Comparing Presidents</span></a></li><li class="nav-item" role="presentation"><a id="tab-prediction-and-modeling" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#prediction-and-modeling" data-scrolling="false" href="#prediction-and-modeling" aria-controls="prediction-and-modeling" aria-selected="false"><span class="nav-link-text">Prediction and Modeling</span></a></li><li class="nav-item" role="presentation"><a id="tab-references" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#references" data-scrolling="false" href="#references" aria-controls="references" aria-selected="false"><span class="nav-link-text">References</span></a></li></ul><div class="quarto-dashboard-links"><a class="quarto-dashboard-link" href="https://github.com/louiseoh18/project04-goldmagikarp.git"><i class="bi bi-github"></i></a></div></div></div>
</nav>
</header>
<div class="page-layout-custom quarto-dashboard-content bslib-gap-spacing html-fill-container bslib-page-fill quarto-dashboard-pages">  

<div class="bslib-grid-item html-fill-item tab-content bslib-grid" data-layout="fill" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div id="home" class="dashboard-page tab-pane show active html-fill-item html-fill-container" data-orientation="rows" aria-labelledby="tab-home">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 78fr) minmax(3em, 22fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card html-fill-item html-fill-container bslib-card" data-fill="false" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<p><strong>Welcome to Executive Economics!</strong><br></p>
<p>This dashboard is designed to provide an accessible overview of historical presidential approval ratings, and explore how different economic indicators may play a role in a leader’s public perception. The dashboard is interactive and user-friendly, allowing users to select different presidents, toggle between economic indicators of interest, and even modify values of economic indicators to predict how they will influence the approval rating of the current U.S. president.</p>
<p><strong>TUTORIAL</strong><br></p>
<ol type="1">
<li><strong>Historical Data</strong>
<ul>
<li>Select a U.S. president you would like to examine.</li>
<li>The graph immediately below your selection will display all available approval ratings over the course of the president’s term(s). This graph also includes important historical events to give context to potential changes in ratings.</li>
<li>On the bottom graph, you can toggle between economic indicators which will display how those indicators changed over the course of the president’s term(s).</li>
<li>Since both the approval rating graph and indicator graph span the same time frame, you can directly compare the two.</li>
<li>See how approval ratings and economic indicators were different between various presidents.</li>
<li>A summary table and party affiliation banner are also provided to the left for reference. <br><br></li>
</ul></li>
<li><strong>Comparing Presidents</strong>
<ul>
<li>Select two or more U.S. presidents to compare.</li>
<li>The graphs below will display approval, disapproval, and unsure ratings respectively for all presidents over their time in office (measured in months).</li>
<li>Because presidents’ data are displayed together, you can easily compare differences in approval ratings between leaders. <br><br></li>
</ul></li>
<li><strong>Prediction and Modeling</strong>
<ul>
<li>The graph displays our pre-trained model’s prediction for the current president’s approval rating for the next 6 months (status quo). This model was trained based on the historical approval ratings and economic indicators from the dashboard’s previous page.</li>
<li>The dotted blue line shows the status quo which is predicted approval rating assuming most recent economic data stays consistent indefinitely.</li>
<li>The red line shows the simulated prediction based on your own “what-if” scenarios. You can modify the economic indicators in the side panel to the left to see how each one may change the president’s approval rating.</li>
<li>You can see summaries of these predicted approval ratings in the right-most panels for the status quo and the simulation (6-month and long-term predictions).</li>
</ul></li>
</ol>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, max-content); grid-auto-columns: minmax(0, 1fr);">
<div class="card html-fill-item html-fill-container bslib-card" data-fill="false" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<p><img src="images/Executive_Economics_Logo.png" class="img-fluid"> <img src="images/Money.png" class="img-fluid"></p>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div>
</div>
<div id="historical-data" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="rows" aria-labelledby="tab-historical-data">
<div class="html-fill-item html-fill-container dashboard-toolbar-container"><div class="toolbar html-fill-container" data-layout="flow">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="president-label" for="president">Choose a President:</label>
<div>
<select class="shiny-input-select form-control" id="president"><option value="Trump (2nd Term)" selected="">Trump (2nd Term)</option>
<option value="Joe Biden">Joe Biden</option>
<option value="Trump (1st Term)">Trump (1st Term)</option>
<option value="Barack Obama">Barack Obama</option>
<option value="George W. Bush">George W. Bush</option>
<option value="Bill Clinton">Bill Clinton</option>
<option value="George Bush">George Bush</option>
<option value="Ronald Reagan">Ronald Reagan</option>
<option value="Jimmy Carter">Jimmy Carter</option>
<option value="Gerald Ford">Gerald Ford</option>
<option value="Richard Nixon">Richard Nixon</option>
<option value="Lyndon B. Johnson">Lyndon B. Johnson</option>
<option value="John F. Kennedy">John F. Kennedy</option>
<option value="Dwight D. Eisenhower">Dwight D. Eisenhower</option>
<option value="Harry Truman">Harry Truman</option>
<option value="Franklin D. Roosevelt">Franklin D. Roosevelt</option></select>
</div>
</div>
</div>
</div><div class="toolbar-content html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr) minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 20fr) minmax(3em, 80fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Summary" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container">Summary</div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="snapshot_tbl" class="shiny-html-output shiny-table-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="U.S. Presidential Approval Ratings" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container">U.S. Presidential Approval Ratings</div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="shiny-plot-output html-fill-item html-fill-container" id="approval_plot" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 20fr) minmax(3em, 80fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr) minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div id="party_banner" class="shiny-html-output html-fill-item html-fill-container"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container no-overflow-x">
<div class="form-group shiny-input-container html-fill-item html-fill-container">
<label class="control-label" id="econ_var-label" for="econ_var">Select Economic Indicator:</label>
<div class="html-fill-item html-fill-container">
<select id="econ_var" class="shiny-input-select"><option value="Real_GDP" selected="">Real GDP</option>
<option value="Disposable_Income">Disposable Income</option>
<option value="Corporate_Profits">Corporate Profits</option>
<option value="Healthcare_Price_Index">Healthcare Price Index</option>
<option value="Gov_Spending">Government Spending</option>
<option value="Personal_Saving_Rate">Personal Savings Rate</option>
<option value="unemployment_rate">Unemployment Rate</option>
<option value="consumer_p_index">Consumer Price Index</option>
<option value="total_nonfarm_jobs">Total Jobs</option>
<option value="avg_hourly_earnings">Average Hourly Earnings</option></select>
<script type="application/json" data-for="econ_var" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Economic Indicators" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container">Economic Indicators</div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="shiny-plot-output html-fill-item html-fill-container" id="econ_plot" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div>
</div></div>
</div>
<div id="comparing-presidents" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container dashboard-sidebar-container" data-orientation="rows" aria-labelledby="tab-comparing-presidents">
<div class="bslib-sidebar-layout html-fill-item html-fill-container" data-bslib-sidebar-open="desktop" data-bslib-sidebar-init="true" data-bslib-sidebar-border="false" data-bslib-sidebar-border-radius="false"><div class="main html-fill-container html-fill-item"><div class="sidebar-content html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Comparing Approval Ratings for U.S. Presidents" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container">Comparing Approval Ratings for U.S. Presidents</div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="shiny-plot-output html-fill-item html-fill-container" id="comparison_approval_plot" style="width:100%;height:400px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div></div><aside id="bslib-sidebar-1" class="sidebar html-fill-container html-fill-item"><div class="html-fill-item html-fill-container">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="pres-label" for="pres">Choose Presidents</label>
<div>
<select id="pres" class="shiny-input-select" multiple="multiple"><option value="Harry Truman">Harry Truman</option>
<option value="Franklin D. Roosevelt">Franklin D. Roosevelt</option>
<option value="Dwight D. Eisenhower">Dwight D. Eisenhower</option>
<option value="John F. Kennedy">John F. Kennedy</option>
<option value="Lyndon B. Johnson">Lyndon B. Johnson</option>
<option value="Richard Nixon">Richard Nixon</option>
<option value="Gerald Ford">Gerald Ford</option>
<option value="Jimmy Carter">Jimmy Carter</option>
<option value="Ronald Reagan">Ronald Reagan</option>
<option value="George Bush">George Bush</option>
<option value="Bill Clinton">Bill Clinton</option>
<option value="George W. Bush">George W. Bush</option>
<option value="Barack Obama">Barack Obama</option>
<option value="Donald Trump" selected="">Donald Trump</option>
<option value="Joe Biden" selected="">Joe Biden</option></select>
<script type="application/json" data-for="pres">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<span class="help-block">To add more presidents, click box above to expand drop down menu and select name(s). Use Backspace to remove presidents. If you want to remove a specific president, only select that president and use backspace.</span>
</div>
</div></aside>
<button class="collapse-toggle" type="button" title="Toggle sidebar" aria-expanded="true" aria-controls="bslib-sidebar-1">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16" class="bi bi-chevron-left collapse-icon" style="fill:currentColor;" aria-hidden="true" role="img">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path>
    </svg>
</button>
<script data-bslib-sidebar-init="">
bslib.Sidebar.initCollapsibleAll()
</script>
</div>
</div>
<div id="prediction-and-modeling" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container dashboard-sidebar-container" data-orientation="rows" aria-labelledby="tab-prediction-and-modeling">
<div class="bslib-sidebar-layout html-fill-item html-fill-container" data-bslib-sidebar-open="desktop" data-bslib-sidebar-init="true"><div class="main html-fill-container html-fill-item"><div class="sidebar-content html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 80fr) minmax(3em, 20fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 65fr) minmax(3em, 35fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-title="Presidential Approval Forecaster: Trump 2nd Term" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header"><div class="card-title html-fill-item html-fill-container">Presidential Approval Forecaster: Trump 2nd Term</div></div>
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="shiny-plot-output html-fill-item html-fill-container" id="forecastPlot" style="width:100%;height:500px;"></div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div style="overflow-y: scroll; height: 100%; padding-right: 10px;" class="html-fill-item html-fill-container">
<h5>Algorithm: Recursive Random Forest</h5>
<p style="font-size: 0.9em; color: #555;">This dashboard uses a Random Forest regressor, an ensemble learning method that aggregates predictions from multiple decision trees. Unlike linear models, it captures complex, non-linear relationships (e.g., voters may punish high inflation differently than they reward low inflation).</p>
<h6>How the Forecast Works:</h6>
<ul style="font-size: 0.9em; color: #555;">
<li>
<b>Recursive Step:</b>
 The model predicts one month ahead (t+1). It then assumes that prediction is fact and uses it to predict month t+2. This allows long-term forecasting but means uncertainty compounds over time.
</li>
<li>
<b>Anchoring:</b>
 To prevent jumps, the forecast is 'anchored' to the last known actual approval rating.
</li>
<li>
<b>Economic Inputs:</b>
 The red line reacts to the 10 economic levers on the left. The blue line assumes today's economy stays frozen forever.
</li>
</ul>
<h6>Limitations &amp; Uncertainty:</h6>
<p style="font-size: 0.85em; font-style: italic; color: #777;">This model is purely economistic. It does not account for exogenous shocks such as geopolitical conflicts, scandals, or social unrest. Prediction intervals are not shown, but users should assume wider uncertainty ranges as the forecast moves further into 2027.</p>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div><div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 40fr) minmax(3em, 60fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="alert html-fill-item html-fill-container" style="background-color: #2980b9;">
<h6>
Status Quo (May '26)<br>
<span style="font-weight: bold; font-size: 2.0em;">
<span id="status_quo_score" class="shiny-text-output"></span>
</span>
</h6>
<p style="color: black; font-size: 0.9em;">Prediction if economy stays exactly as it is today.</p>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="alert html-fill-item html-fill-container" style="background-color: #D55E00;">
<h6>
Scenario (May '26)<br>
<span style="font-weight: bold; font-size: 2.0em;">
<span id="six_month_score" class="shiny-text-output"></span>
</span>
</h6>
<p style="color:black; font-size: 0.9em;">Prediction based on your inputs.</p>
<h6>
<br><br>Long-Term (Dec '27)<br>
<span style="font-weight: bold; font-size: 2.0em;">
<span id="final_score" class="shiny-text-output"></span>
</span>
</h6>
<span style="font-size: 0.9em; color: black;">
<div id="change_score" class="shiny-text-output html-fill-item html-fill-container"></div>
</span>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div>
</div></div><aside id="bslib-sidebar-2" class="sidebar html-fill-container html-fill-item"><div class="html-fill-item html-fill-container">
<section id="economic-trajectory">
<div class="h3">
Economic

Trajectory
</div>
<p>Define the start and end points. The model simulates the trend between them.</p>
<div class="cell-output-display">
<hr>
</div>
<div class="cell-output-display">
<div>
<h6>Unemployment Rate (%)</h6>
<div class="shiny-split-layout">
<div style="width: 50.000%;">
<div class="form-group shiny-input-container">
<label class="control-label" id="unemp_start-label" for="unemp_start">Start (Jan '26)</label>
<input id="unemp_start" type="number" class="shiny-input-number form-control" value="4.5" data-update-on="change" step="0.1">
</div>
</div>
<div style="width: 50.000%;">
<div class="form-group shiny-input-container">
<label class="control-label" id="unemp_end-label" for="unemp_end">End (Dec '27)</label>
<input id="unemp_end" type="number" class="shiny-input-number form-control" value="5" data-update-on="change" step="0.1">
</div>
</div>
</div>
</div>
</div>
<div class="cell-output-display">
<div>
<h6>Inflation Rate (Year-over-Year %)</h6>
<div class="shiny-split-layout">
<div style="width: 50.000%;">
<div class="form-group shiny-input-container">
<label class="control-label" id="inf_start-label" for="inf_start">Start</label>
<input id="inf_start" type="number" class="shiny-input-number form-control" value="3" data-update-on="change" step="0.1">
</div>
</div>
<div style="width: 50.000%;">
<div class="form-group shiny-input-container">
<label class="control-label" id="inf_end-label" for="inf_end">End</label>
<input id="inf_end" type="number" class="shiny-input-number form-control" value="2.5" data-update-on="change" step="0.1">
</div>
</div>
</div>
</div>
</div>
<div class="cell-output-display">
<div>
<h6>GDP Growth (Year-over-Year %)</h6>
<div class="shiny-split-layout">
<div style="width: 50.000%;">
<div class="form-group shiny-input-container">
<label class="control-label" id="gdp_start-label" for="gdp_start">Start</label>
<input id="gdp_start" type="number" class="shiny-input-number form-control" value="2.5" data-update-on="change" step="0.1">
</div>
</div>
<div style="width: 50.000%;">
<div class="form-group shiny-input-container">
<label class="control-label" id="gdp_end-label" for="gdp_end">End</label>
<input id="gdp_end" type="number" class="shiny-input-number form-control" value="1.8" data-update-on="change" step="0.1">
</div>
</div>
</div>
</div>
</div>
<div class="cell-output-display">
<hr>
</div>
<div class="cell-output-display">
<h6>Secondary Factors (Avg)</h6>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container no-baseline">
<label class="control-label" id="wages-label" for="wages">Wage Growth (%):</label>
<input class="js-range-slider" id="wages" data-skin="shiny" data-min="0" data-max="6" data-from="3.5" data-step="0.1" data-grid="true" data-grid-num="10" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container no-baseline">
<label class="control-label" id="healthcare-label" for="healthcare">Healthcare Inflation (%):</label>
<input class="js-range-slider" id="healthcare" data-skin="shiny" data-min="0" data-max="10" data-from="6" data-step="0.5" data-grid="true" data-grid-num="10" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container no-baseline">
<label class="control-label" id="jobs-label" for="jobs">Job Growth (%):</label>
<input class="js-range-slider" id="jobs" data-skin="shiny" data-min="-2" data-max="4" data-from="1" data-step="0.1" data-grid="true" data-grid-num="10" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container no-baseline">
<label class="control-label" id="market-label" for="market">Corp. Profit Growth (%):</label>
<input class="js-range-slider" id="market" data-skin="shiny" data-min="-10" data-max="15" data-from="4" data-step="1" data-grid="true" data-grid-num="8.33333333333333" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
<div class="cell-output-display">
<button class="btn btn-default action-button btn-secondary" id="reset" style="width:100%;" type="button">Reset Scenarios</button>
</div>
</section>
</div></aside>
<button class="collapse-toggle" type="button" title="Toggle sidebar" aria-expanded="true" aria-controls="bslib-sidebar-2">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16" class="bi bi-chevron-left collapse-icon" style="fill:currentColor;" aria-hidden="true" role="img">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path>
    </svg>
</button>
<script data-bslib-sidebar-init="">
bslib.Sidebar.initCollapsibleAll()
</script>
</div>
</div>
<div id="references" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="rows" aria-labelledby="tab-references">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, max-content) minmax(3em, max-content); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card html-fill-item html-fill-container bslib-card" data-fill="false" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<p>The data was pulled from a variety of databases using API’s and web scraping techniques. Data used for exploratory analysis and dashboard modeling include presidential approval ratings from The American Presidency Project, and economic indicators from the Bureau of Labor Statistics (BLS) and Bureau of Economic Analysis (BEA). U.S. Census and American National Election Studies (ANES) data were also explored for potential insights but were not used in the final dashboard or model due to data frequency limitations.</p>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card html-fill-item html-fill-container bslib-card" data-fill="false" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<p><strong>All Data Sources</strong> <br></p>
<div id="refs" class="references csl-bib-body hanging-indent html-fill-item html-fill-container" data-entry-spacing="0" role="list">
<div id="ref-anes" class="csl-entry html-fill-item html-fill-container" role="listitem">
American National Election Studies (ANES). 2023. <span>“ANES Time Series Studies.”</span> <a href="https://electionstudies.org/data-center/">https://electionstudies.org/data-center/</a>.
</div>
<div id="ref-bea_api" class="csl-entry html-fill-item html-fill-container" role="listitem">
Bureau of Economic Analysis (BEA). 2025. <span>“BEA Data API.”</span> <a href="https://apps.bea.gov/API/signup/">https://apps.bea.gov/API/signup/</a>.
</div>
<div id="ref-bls_api" class="csl-entry html-fill-item html-fill-container" role="listitem">
United States Bureau of Labor Statistics (BLS). 2016. <span>“BLS Public Data API.”</span> <a href="https://www.bls.gov/developers/home.htm">https://www.bls.gov/developers/home.htm</a>.
</div>
<div id="ref-census_api" class="csl-entry html-fill-item html-fill-container" role="listitem">
United States Census Bureau. 2025. <span>“Census Data API Key.”</span> <a href="https://api.census.gov/data/key_signup.html">https://api.census.gov/data/key_signup.html</a>.
</div>
<div id="ref-approval_ratings" class="csl-entry html-fill-item html-fill-container" role="listitem">
Woolley, John, and Gerhard Peters. 2025. <span>“The American Presidency Project.”</span> <a href="https://www.presidency.ucsb.edu/">https://www.presidency.ucsb.edu/</a>.
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div id="3ade8a4a-fb1d-4a6c-8409-ac45482d5fc9" class="hidden html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
</div>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
library(here)
library(shiny)
library(lubridate)
library(ggplot2)
library(tidyverse)
library(randomForest)
library(zoo)

# TO-DO:
# Reference page: Can maybe format into columns for better aesthetics (minimize white space).
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
load(here("data/complete_data.rda"))
final_combined_data <- final_combined_data %>%
  arrange(desc(date))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
econ_labels <- c(
  "Real GDP" = "Real_GDP",
  "Disposable Income" = "Disposable_Income",
  "Corporate Profits" = "Corporate_Profits",
  "Healthcare Price Index" = "Healthcare_Price_Index",
  "Government Spending" = "Gov_Spending",
  "Personal Savings Rate" = "Personal_Saving_Rate",
  "Unemployment Rate" = "unemployment_rate",
  "Consumer Price Index" = "consumer_p_index",
  "Total Jobs" = "total_nonfarm_jobs",
  "Average Hourly Earnings" = "avg_hourly_earnings"
)
pres_data <- reactive({
    final_combined_data |> filter(president %in% input$president)
  })

# Summary table
output$snapshot_tbl <- renderTable({
  var <- input$econ_var
  req(input$president)
  pres_data() |>
    select(approval_rating, disapproval_rating, input$econ_var) |>
    rename("Approval Rating (%)" = approval_rating,
           "Disapproval Rating (%)" = disapproval_rating,
           !!names(econ_labels)[econ_labels == var]:= all_of(var))
  })
  
# Approval rating plot
output$approval_plot <- renderPlot({
  plot_data <- pres_data()
  
  events_data <- plot_data |>
    filter(!is.na(important_events))
  
  ggplot(plot_data, aes(x = date)) +
    geom_line(aes(y = approval_rating, color = "Approval"), size = 1) +
    geom_line(aes(y = disapproval_rating, color = "Disapproval"), size = 1) +
    geom_line(aes(y = unsure_rating, color = "Unsure"), size = 1) +
    
    geom_vline(data = events_data, 
               aes(xintercept = date), 
               linetype = "dashed", color = "gray50", alpha = 0.6) +
    
    geom_text(data = events_data, 
              aes(x = date, y = 30, label = important_events), 
              angle = 90, vjust = -0.6, size = 4, color = "gray30") +
    
    scale_color_manual(values = c("#61D04F", "#DF536B", "#2297E6")) +
    labs(y = "Rating (%)", x = "Date", color = "Rating") +
    theme_minimal(base_size = 16) +
    theme(legend.position = "bottom")
})

# Presidential Party
output$party_banner <- renderUI({
  party <- pres_data()$Party[1] 
  
  if (!is.na(party) && party == "Republican") {
    bg_color <- "#EE0000" # Republican Red
  } else {
    bg_color <- "#4F94CD" # Democratic Blue
  }
  div(
    class = "alert", 
    style = paste0("background-color: ", bg_color, "; ",
                   "display: flex; flex-direction: column; justify-content: center; ",
                   "align-items: center; height: 80px; text-align: center; border: none;"),
    
    h6(HTML("Party:<br>"), 
       style = "color: white; margin: 0;",
       span(party, 
            style = "color: white; font-weight: bold; font-size: 1.5em;")
    )
  )
})

# Economic indicator plot
output$econ_plot <- renderPlot({
    var <- input$econ_var
    friendly_label <- names(econ_labels)[econ_labels == var]
    pres_data() |>
      ggplot(aes(x = date, y = .data[[var]])) +
      geom_line(color = "mediumpurple", linewidth = 1) +
      labs(y = friendly_label, x = "Date") +
      theme_minimal(base_size = 16)
  })




</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
load(here("data/comparison_data.rda"))
</script>
 
<script type="application/shiny-prerendered" data-context="server">

presi_data <- reactive({
  req(input$pres)
  approval_comparison_data |> filter(president %in% input$pres)
})

output$comparison_approval_plot <- renderPlot({
  req(nrow(presi_data()) > 0)
  
  # 1. Pivot data to make it "tidy" for ggplot
  # This puts Approval, Disapproval, and Unsure into one 'value' column
  plot_data <- presi_data() |>
    pivot_longer(
      cols = c(approval_rating, disapproval_rating, unsure_rating),
      names_to = "rating_type",
      values_to = "value"
    ) |>
    mutate(
      rating_type = factor(rating_type, 
                           levels = c("approval_rating", "disapproval_rating", "unsure_rating"),
                           labels = c("Approval", "Disapproval", "Unsure"))
    )

  # 2. Plot with Facets
  ggplot(plot_data, aes(x = months_in_office, y = value, color = president)) +
    geom_line(linewidth = 1) +
    
    # Creates 3 side-by-side panels
    facet_wrap(~rating_type, nrow = 3) + 
    
    # Now use Color for Presidents (Distinct & Clear)
    scale_color_brewer(palette = "Set1") + 
    
    labs(y = "Rating (%)", x = "Months in Office", color = "President") +
    theme_minimal(base_size = 14) +
    theme(legend.position = "bottom")
})

</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
rf_model <- readRDS(here("data/rf_approval_model.rds"))
trump_history <- readRDS(here("data/trump_history.rds"))


last_actual_row <- tail(trump_history, 1)
start_date <- last_actual_row$date
start_approval <- last_actual_row$approval_rating

last_3_approvals <- tail(trump_history$approval_rating, 3)
if(length(last_3_approvals) < 3) {
  last_3_approvals <- rep(start_approval, 3)
}

</script>
 
<script type="application/shiny-prerendered" data-context="server">
observeEvent(input$reset, {
    updateNumericInput(session, "unemp_start", value = 4.5)
    updateNumericInput(session, "unemp_end", value = 5.0)
    updateNumericInput(session, "inf_start", value = 3.0)
    updateNumericInput(session, "inf_end", value = 2.5)
    updateNumericInput(session, "gdp_start", value = 2.5)
    updateNumericInput(session, "gdp_end", value = 1.8)
    updateSliderInput(session, "wages", value = 3.5)
    updateSliderInput(session, "healthcare", value = 6.0)
    updateSliderInput(session, "jobs", value = 1.0)
    updateSliderInput(session, "market", value = 4.0)
  })
  
  forecast_data <- reactive({
    future_dates <- seq(start_date + months(1), as.Date("2027-12-01"), by = "month")
    n_months <- length(future_dates)
    
    unemp_seq <- seq(input$unemp_start, input$unemp_end, length.out = n_months)
    inf_seq   <- seq(input$inf_start, input$inf_end, length.out = n_months)
    gdp_seq   <- seq(input$gdp_start, input$gdp_end, length.out = n_months)
    
    df <- data.frame(
      date = future_dates,
      president = "Trump (2nd Term)", 
      Party = "Republican",
      Year_Index = year(future_dates),
      Months_in_Office = seq(11, 11 + n_months - 1),
      Honeymoon = 0,
      
      Unemployment      = unemp_seq,
      Inflation_Rate    = inf_seq,
      GDP_Growth        = gdp_seq,
      Wage_Growth       = rep(input$wages, n_months),
      Healthcare_Infl   = rep(input$healthcare, n_months),
      Job_Growth        = rep(input$jobs, n_months),
      Profit_Growth     = rep(input$market, n_months),
      Income_Growth     = rep(2.0, n_months), 
      Gov_Spend_Growth  = rep(1.0, n_months),
      Savings_Rate      = rep(4.0, n_months),
      
      Approval_Lag3     = NA,
      approval_rating   = NA
    )
    
    approval_buffer <- last_3_approvals
    
    for(i in 1:n_months) {
      df$Approval_Lag3[i] <- approval_buffer[1]
      pred_val <- predict(rf_model, newdata = df[i, ])
      df$approval_rating[i] <- pred_val
      approval_buffer <- c(approval_buffer[-1], pred_val)
    }
    
    first_pred <- df$approval_rating[1]
    anchor_gap <- start_approval - first_pred
    df$approval_rating <- df$approval_rating + anchor_gap
    
    df$Type <- "Custom Scenario"
    return(df)
  })
  
  baseline_forecast <- reactive({
    future_dates <- seq(start_date + months(1), as.Date("2027-12-01"), by = "month")
    n_months <- length(future_dates)
    
    df <- data.frame(
      date = future_dates,
      president = "Trump (2nd Term)", 
      Party = "Republican",
      Year_Index = year(future_dates),
      Months_in_Office = seq(11, 11 + n_months - 1),
      Honeymoon = 0,
      
      Unemployment      = rep(4.5, n_months),
      Inflation_Rate    = rep(3.1, n_months),
      GDP_Growth        = rep(2.3, n_months),
      Wage_Growth       = rep(4.0, n_months),
      Healthcare_Infl   = rep(5.5, n_months),
      Job_Growth        = rep(1.1, n_months),
      Profit_Growth     = rep(4.5, n_months),
      Income_Growth     = rep(2.0, n_months), 
      Gov_Spend_Growth  = rep(1.0, n_months),
      Savings_Rate      = rep(4.5, n_months),
      
      Approval_Lag3     = NA,
      approval_rating   = NA
    )
    
    approval_buffer <- last_3_approvals
    
    for(i in 1:n_months) {
      df$Approval_Lag3[i] <- approval_buffer[1]
      pred_val <- predict(rf_model, newdata = df[i, ])
      df$approval_rating[i] <- pred_val
      approval_buffer <- c(approval_buffer[-1], pred_val)
    }
    
    first_pred <- df$approval_rating[1]
    anchor_gap <- start_approval - first_pred
    df$approval_rating <- df$approval_rating + anchor_gap
    
    df$Type <- "Status Quo"
    return(df)
  })
  
  output$forecastPlot <- renderPlot({
    fc_custom <- forecast_data()
    fc_base <- baseline_forecast()
    
    hist_plot <- trump_history %>% mutate(Type = "Actual History")
    bridge_custom <- last_actual_row; bridge_custom$Type <- "Custom Scenario"
    bridge_base <- last_actual_row; bridge_base$Type <- "Status Quo"
    
    plot_df <- bind_rows(
      hist_plot, 
      bridge_custom, fc_custom %>% select(date, approval_rating, Type),
      bridge_base, fc_base %>% select(date, approval_rating, Type)
    )
    
    six_month_date <- start_date + months(6)
    
    ggplot(plot_df, aes(x = date, y = approval_rating, color = Type, linetype = Type, size = Type)) +
      geom_line() +
      geom_point(data = filter(plot_df, Type == "Actual History"), size = 3, alpha = 0.8) +
      
      geom_vline(xintercept = start_date, linetype = "dotted", color = "gray50") +
      geom_vline(xintercept = six_month_date, linetype = "dashed", color = "#f39c12", alpha = 0.6) +
      annotate("text", x = six_month_date, y = max(plot_df$approval_rating, na.rm=T), 
               label = "6 Months", angle = 90, vjust = -1, color = "#f39c12") +
      
      scale_color_manual(values = c("Actual History" = "black", "Custom Scenario" = "#D55E00", "Status Quo" = "#2980b9")) +
      scale_linetype_manual(values = c("Actual History" = "solid", "Custom Scenario" = "dashed", "Status Quo" = "dotted")) +
      scale_size_manual(values = c("Actual History" = 1.5, "Custom Scenario" = 1.5, "Status Quo" = 1.2)) +
      
      labs(y = "Approval Rating (%)", x = "Year") +
      theme_minimal(base_size = 16) +
      theme(legend.position = "bottom") +
      coord_cartesian(ylim = c(25, 60))
  })
  
  output$six_month_score <- renderText({
    val <- forecast_data()$approval_rating[6]
    paste0(round(val, 1), "%")
  })
  
  output$status_quo_score <- renderText({
    val <- baseline_forecast()$approval_rating[6]
    paste0(round(val, 1), "%")
  })
  
  output$final_score <- renderText({
    val <- tail(forecast_data()$approval_rating, 1)
    paste0(round(val, 1), "%")
  })
  
  output$change_score <- renderText({
    start_val <- start_approval
    end_val <- tail(forecast_data()$approval_rating, 1)
    diff <- end_val - start_val
    sign <- ifelse(diff >= 0, "+", "")
    paste0("(", sign, round(diff, 1), "% from today)")
  })

</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.11.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68]}},"value":[{"type":"character","attributes":{},"value":["base","bslib","cachem","cli","compiler","datasets","digest","dplyr","evaluate","farver","fastmap","forcats","generics","ggplot2","glue","graphics","grDevices","grid","gtable","here","hms","htmltools","htmlwidgets","httpuv","jquerylib","jsonlite","knitr","later","lattice","lifecycle","lubridate","magrittr","memoise","methods","mime","pillar","pkgconfig","promises","purrr","R6","randomForest","RColorBrewer","Rcpp","readr","rlang","rmarkdown","rprojroot","rstudioapi","sass","scales","shiny","stats","stringi","stringr","tibble","tidyr","tidyselect","tidyverse","timechange","tools","tzdb","utils","vctrs","withr","xfun","xtable","yaml","zoo"]},{"type":"character","attributes":{},"value":["4.5.1","0.9.0","1.1.0","3.6.5","4.5.1","4.5.1","0.6.37","1.1.4","1.0.4","2.1.2","1.2.0","1.0.0","0.1.4","3.5.2","1.8.0","4.5.1","4.5.1","4.5.1","0.3.6","1.0.1","1.1.3","0.5.8.1","1.6.4","1.6.16","0.1.4","2.0.0","1.50","1.4.4","0.22-7","1.0.4","1.9.4","2.0.3","2.0.1","4.5.1","0.13","1.11.0","2.0.3","1.3.3","1.1.0","2.6.1","4.7-1.2","1.1-3","1.1.0","2.1.5","1.1.6","2.29","2.1.1","0.17.1","0.4.10","1.4.0","1.11.1","4.5.1","1.8.7","1.5.1","3.3.0","1.3.1","1.2.1","2.0.0","0.3.0","4.5.1","0.5.0","4.5.1","0.6.5","3.0.2","0.53","1.8-4","2.3.10","1.8-14"]}]}]}
</script>
<!--/html_preserve-->


<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /container fluid -->

<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (_event) {
  if (window.bslib.Card) {
    window.bslib.Card.initializeAllCards();
  }
}); 
</script>
  



</body></html>